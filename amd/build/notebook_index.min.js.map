{"version":3,"file":"notebook_index.min.js","sources":["../src/notebook_index.js"],"sourcesContent":["/* eslint-disable no-restricted-globals */\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Controls the notebook index.\n *\n * @module     local_notebook/notebook_index\n * @copyright  2022 Université de Montréal\n * @author     Issam Taboubi <issam.taboubi@umontreal.ca>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nrequire.config({\n    enforceDefine: true,\n    shim: {\n        'bootstrapTable': ['jquery'],\n        'bootstrapTableLocale': ['jquery', 'bootstrapTable'],\n        'bootstrapTableLocaleMobile': ['jquery', 'bootstrapTable']\n    },\n    paths: {\n        bootstrapTable: M.cfg.wwwroot + '/local/notebook/amd/build/bootstrap-table.min',\n        bootstrapTableLocale: M.cfg.wwwroot + '/local/notebook/amd/build/bootstrap-table-locale-all.min',\n        bootstrapTableLocaleMobile: M.cfg.wwwroot + '/local/notebook/amd/build/bootstrap-table-mobile.min'\n    }\n});\n\ndefine(\n    [\n        'jquery',\n        'core/notification',\n        'core/str',\n        'core/ajax',\n        'core/templates',\n        'bootstrapTable',\n        'bootstrapTableLocale',\n        'bootstrapTableLocaleMobile',\n    ], function(\n        $,\n        notification,\n        str,\n        ajax,\n        Templates\n    ) {\n\n    var SELECTORS = {\n        NOTEBOOKCONTAINER: '.notebookcontainer',\n        NOTEINDEX: '[data-region=\"notebook-index\"]',\n        HEADER_CONTAINER: '[data-region=\"header-container\"]',\n        BODY_CONTAINER: '[data-region=\"body-container\"]',\n        FORM_CONTAINER: '[data-region=\"form-note\"]',\n        CLOSE_BUTTON: '[data-action=\"closedrawer\"]',\n        NOTE_LIST_CONTAINER: '[data-region=\"notebook-index\"] .notelistcontainer',\n        NOTE_TABLE_CONTAINER: '#notebook-table-index-container',\n        NOTE_TABLE: '#notebook-table-index',\n        NOTE_TABLE_LOADING: '#notebook-table-index-loading',\n        REFRESH_BUTTON: 'button[name=\"refresh\"]',\n        SAVE_BUTTON: '#savenote',\n        CANCEL_BUTTON: '#cancel-add-edit',\n        NOTE_FORM_ID: 'noteform',\n        NOTE_SUMMARY: '#id_notebook_editor',\n        VIEW_NOTE: '#notebook-table-index .viewnote',\n        NOTE_VIEW: '[data-region=\"notebook-index\"] .view-note',\n        NOTE_TABLE_ROW: '#notebook-table-index tr',\n        FOOTER_NOTE_VIEW: '[data-region=\"footer-container\"] [data-region=\"view-note\"]',\n        HEADER_NOTE_VIEW: '[data-region=\"header-container\"] [data-region=\"view-note\"]',\n        HEADER_NOTE_CREATED_DATE: '[data-region=\"header-container\"] .notecreateddate',\n        HEADER_NOTE_LAST_MODIFIED_DATE: '[data-region=\"header-container\"] .notelastmodifieddate',\n        NOTE_FORM: '[data-region=\"form-note\"] #noteform',\n        HEADER_NOTE_HIDE_LIST: '[data-region=\"header-container\"] .hidelist',\n        HEADER_NOTE_SHOW_LIST: '[data-region=\"header-container\"] .showlist',\n        HEADER_NOTE_DELETE: '[data-region=\"header-container\"] .deletenote',\n        HEADER_NOTE_EDIT: '[data-region=\"header-container\"] .editnote',\n        FOOTER_NOTE_TAGS: '[data-region=\"footer-container\"] .notetags',\n        MESSAGE_SUCCESS_CONTAINER: '.notebookcontainer .messagesuccesscontainer',\n        DIALOGUE_CONTAINER: '.notebookcontainer [data-region=\"confirm-dialogue-container\"]',\n        CONFIRM_TEXT_MULTI: '.notebookcontainer [data-region=\"confirm-dialogue-container\"] ' +\n            '.multiplenotes',\n        CONFIRM_TEXT_SINGLE: '.notebookcontainer [data-region=\"confirm-dialogue-container\"] ' +\n            '.singlenote',\n        CONFIRM_DELETE_BUTTON_MULTI: '[data-region=\"confirm-dialogue-container\"] [data-action=\"confirm-delete-multiple\"]',\n        CONFIRM_DELETE_BUTTON_SINGLE: '[data-region=\"confirm-dialogue-container\"] [data-action=\"confirm-delete-single\"]',\n        CANCEL_DELETE_BUTTON_MULTI: '[data-region=\"confirm-dialogue-container\"] [data-action=\"cancel-delete-multiple\"]',\n        CANCEL_DELETE_BUTTON_SINGLE: '[data-region=\"confirm-dialogue-container\"] [data-action=\"cancel-delete-single\"]',\n        DELETE_NOTE_BUTTON: '.deletenote',\n        CHECKBOX_LIST_NOTE: '[name=\"btSelectItem\"]',\n        CHECKBOX_ALL_NOTE: '[name=\"btSelectAll\"]',\n        TABLE_DELETE_BUTTON: '[data-region=\"notebook-index\"] #remove',\n        TABLE_PAGINATION: '[data-region=\"notebook-index\"] .fixed-table-pagination',\n        NOTE_DETAIL_CONTAINER: '#notedetailcontainer'\n\n    };\n    /** Editor listeners state */\n    var editorListenersInitialized = false;\n    var listNotesHidden = false;\n\n    /**\n     * Refresh notes.\n     *\n     */\n    var refreshNotes = () => {\n        let previousPageNumber = this.$table.bootstrapTable('getOptions').pageNumber;\n        this.$table.bootstrapTable('destroy');\n        displayNotes(previousPageNumber);\n    };\n\n    /**\n     * Get formatted tags.\n     *\n     * @param {Array.<Object>} tags\n     * @return {String} return tags html\n     */\n    var getFormattedTags = (tags) => {\n        var tagshtml = '';\n\n        tags.forEach(function(item) {\n            // TODO: Replace with mustache rendering.\n            // If item has a # it means course or activity has been deleted.\n            let badge = 'badge-info badge-pill';\n            if (item.url === '#') {\n                badge = 'badge-secondary';\n                tagshtml += '<span class=\"badge ' + badge + ' text-truncate context-note\" title=\"' + item.tooltip + '\">'\n                    + item.title + '</span>';\n            } else {\n                tagshtml += '<span class=\"badge ' + badge + ' text-truncate context-note\">'\n                    + '<a title=\"' + item.tooltip + '\" href=\"' + item.url + '\">' + item.title + '</a></span>';\n            }\n        });\n\n        return tagshtml;\n    };\n\n    /**\n     * Add blur note content.\n     *\n     */\n    var addBlurContent = () => {\n        let selectors = SELECTORS.FOOTER_NOTE_VIEW + ', ' + SELECTORS.HEADER_NOTE_CREATED_DATE + ', ' +\n            SELECTORS.HEADER_NOTE_LAST_MODIFIED_DATE + ', ' + SELECTORS.NOTE_VIEW;\n        $(selectors).addClass('blur-content');\n    };\n\n    /**\n     * Remove blur note content.\n     *\n     */\n    var removeBlurContent = () => {\n        let selectors = SELECTORS.FOOTER_NOTE_VIEW + ', ' + SELECTORS.HEADER_NOTE_CREATED_DATE + ', ' +\n            SELECTORS.HEADER_NOTE_LAST_MODIFIED_DATE + ', ' + SELECTORS.NOTE_VIEW;\n        $(selectors).removeClass('blur-content');\n    };\n\n    /**\n     * Display note.\n     *\n     * @param {String} noteid The note id\n     */\n    var displayNote = (noteid) => {\n        var promises = [];\n        displayNoteView();\n        addBlurContent();\n\n        promises = ajax.call([{\n            methodname: 'local_notebook_read_note',\n            args: {\n                noteid: noteid\n            }\n        },\n        {\n            methodname: 'local_notebook_note_viewed',\n            args: {\n                id: noteid\n            }\n        }]);\n        promises[0].done(function(result) {\n            let data = {};\n            data.subject = result.subject;\n            data.summary = result.summary;\n\n            // Note created datetime.\n            let timestamp = result.created * 1000;\n            let datecreation = new Date(timestamp).toLocaleDateString(document.documentElement.lang, {\n                day: 'numeric',\n                month: 'short',\n                year: 'numeric'\n            });\n            let timecreation = new Date(timestamp).toLocaleTimeString(document.documentElement.lang);\n\n            // Note last modified datetime.\n            let lastmodifiedtimestamp = result.lastmodified * 1000;\n            let lastmodifieddate = new Date(lastmodifiedtimestamp).toLocaleDateString(document.documentElement.lang, {\n                day: 'numeric',\n                month: 'short',\n                year: 'numeric'\n            });\n            let lastmodifiedtime = new Date(lastmodifiedtimestamp).toLocaleTimeString(document.documentElement.lang);\n            Templates.render('local_notebook/note_content', data)\n                .then(function(html) {\n                    // Display content.\n                    $(SELECTORS.NOTE_VIEW).html(html);\n                    // Display dates.\n                    $(SELECTORS.HEADER_NOTE_CREATED_DATE).html(datecreation + ' ' + timecreation);\n                    $(SELECTORS.HEADER_NOTE_LAST_MODIFIED_DATE).html(lastmodifieddate + ' ' + lastmodifiedtime);\n                    // Set buttons.\n                    $(SELECTORS.HEADER_NOTE_DELETE).data('noteid', result.id);\n                    $(SELECTORS.HEADER_NOTE_EDIT).data('noteid', result.id);\n                    // Set tags.\n                    $(SELECTORS.FOOTER_NOTE_TAGS).html(getFormattedTags(result.tags));\n                    // Remove blur content.\n                    removeBlurContent();\n                    // Log viewed event.\n                    return promises[1].done(function() { }).fail(Notification.exception);\n                })\n\n                .fail(Notification.exception);\n        }).fail(Notification.exception);\n    };\n\n\n    /**\n     * Display notes.\n     *\n     * @param {Number} pageNumber The pagination page number\n     */\n    var displayNotes = (pageNumber) => {\n        var promises = [];\n\n        promises = ajax.call([{\n            methodname: 'local_notebook_notes_list',\n            args: {\n                userid: this.userid,\n                courseid: this.courseid,\n                coursemoduleid: this.coursemoduleid\n            }\n        }]);\n        var stringkeys = [\n            {\n                key: 'notetitle',\n                component: 'local_notebook'\n            },\n            {\n                key: 'notedate',\n                component: 'local_notebook',\n            },\n            {\n                key: 'displaynote',\n                component: 'local_notebook',\n            },\n            {\n                key: 'lastmodifieddate',\n                component: 'local_notebook',\n            }\n        ];\n\n        // eslint-disable-next-line promise/always-return\n        str.get_strings(stringkeys).then(function(langStrings) {\n            let data = [];\n            promises[0].done(function(result) {\n                $.each(result, function(index, value) {\n                    let subject = {};\n                    subject.text = value.subject;\n                    subject.tags = value.tags;\n                    data.push({\n                        'id': value.id,\n                        'subjecttext': value.subject,\n                        'subject': subject,\n                        'lastmodified': value.lastmodified\n                    });\n                });\n                this.$table.bootstrapTable({\n                    locale: document.documentElement.lang,\n                    paginationParts: ['pageInfo', 'pageSize', 'pageList'],\n                    paginationSuccessivelySize: 2,\n                    paginationPagesBySide: 1,\n                    data: data,\n                    pageNumber: pageNumber,\n                    columns: [\n                        [{\n                            field: 'state',\n                            checkbox: true\n                        },\n                        {\n                            field: 'subjecttext',\n                            visible: false\n                        },\n                        {\n                            field: 'subject',\n                            title: langStrings[0],\n                            sortable: true,\n                            sortName: 'subjecttext',\n                            formatter: function(value) {\n                                let nbtags = value.tags.length;\n                                var td = \"<span class='text-truncate subject'>\" + value.text + \"</span><br>\";\n                                var nbclass = nbtags === 1 ? 'wcn-1' : 'wcn-2';\n                                value.tags.forEach(function(item) {\n                                    // TODO: Replace with mustache rendering.\n                                    // If item has a # it means course or activity has been deleted.\n                                    let badge = 'badge-info badge-pill';\n                                    if (item.url === '#') {\n                                        badge = 'badge-secondary';\n                                        td += '<span class=\"badge ' + badge + ' text-truncate context-note ' + nbclass\n                                            + '\" title=\"' + item.tooltip + '\">' + item.title + '</span>';\n                                    } else {\n                                        td += '<span class=\"badge ' + badge + ' text-truncate context-note ' + nbclass\n                                            + '\"><a title=\"' + item.tooltip + '\" href=\"' + item.url + '\">'\n                                            + item.title + '</a></span>';\n                                    }\n                                });\n                                return td;\n                            }\n                        },\n                        {\n                            field: 'lastmodified',\n                            title: langStrings[1],\n                            sortable: true,\n                            formatter: function(value) {\n                                var today = new Date(value * 1000).toLocaleDateString(document.documentElement.lang, {\n                                    day: 'numeric',\n                                    month: 'short',\n                                    year: 'numeric'\n                                });\n                                return today;\n                            },\n                            width: 110,\n                            titleTooltip: langStrings[3]\n                        },\n                        {\n                            field: 'operate',\n                            title: '',\n                            align: 'center',\n                            width: 35,\n                            formatter: function(value, row) {\n                                return [\n                                    '<a class=\"viewnote\" data-noteid=\"' + row.id + '\" ' +\n                                    'href=\"#notedetailcontainer\" title=\"' + langStrings[2] + '\">',\n                                    '<i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i>',\n                                    '</a>'\n                                ].join('');\n                            }\n                        }]\n                    ],\n                    onPostBody: function() {\n                        // Wrap the second and the third card view for Flexbox.\n                        $(\".card-views\").each(function() {\n                            $(this).find('.card-view').slice(1, 3).wrapAll('<div class=\"item-content\" />');\n                        });\n                        // Hide notebook table loading.\n                        $(SELECTORS.NOTE_TABLE_LOADING).addClass('hidden');\n                        // Display notebook table.\n                        $(SELECTORS.NOTE_TABLE_CONTAINER).removeClass('hidden');\n                        // Init pagination rows per page dropdown.\n                        $(SELECTORS.TABLE_PAGINATION + ' .dropdown-toggle').dropdown();\n                    }\n                });\n            }).fail(notification.exception);\n        }).fail(Notification.exception);\n    };\n\n    /**\n     * Close the confirm delete dialogue..\n     *\n     * @param {String} action The action type of cancel.\n     * @param {Boolean} focus\n     */\n    var closeConfirmDialogue = (action, focus) => {\n        $(SELECTORS.DIALOGUE_CONTAINER).addClass('hidden');\n        if (!focus) {\n            return;\n        }\n        if (action === 'multiple') {\n            $(SELECTORS.TABLE_DELETE_BUTTON).focus();\n        } else {\n            $(SELECTORS.DELETE_NOTE_BUTTON).focus();\n        }\n    };\n\n    /**\n     * Show the confirm delete dialogue..\n     *\n     * @param {String} action\n     */\n    var showConfirmDialogue = (action) => {\n        $(SELECTORS.DIALOGUE_CONTAINER).removeClass('hidden');\n        if (action === 'multiple') {\n            let toshow = SELECTORS.CONFIRM_TEXT_MULTI + ', ' + SELECTORS.CONFIRM_DELETE_BUTTON_MULTI + ',' +\n                SELECTORS.CANCEL_DELETE_BUTTON_MULTI;\n            let tohide = SELECTORS.CONFIRM_TEXT_SINGLE + ', ' + SELECTORS.CONFIRM_DELETE_BUTTON_SINGLE + ',' +\n                SELECTORS.CANCEL_DELETE_BUTTON_SINGLE;\n            $(tohide).addClass('hidden');\n            $(toshow).removeClass('hidden');\n            let list = [];\n            $(SELECTORS.NOTEINDEX + ' ' + SELECTORS.CHECKBOX_LIST_NOTE + ':checked').each(function() {\n                list.push($(this).val());\n            });\n            $(SELECTORS.CONFIRM_DELETE_BUTTON_MULTI).data('noteid', list);\n            $(SELECTORS.CONFIRM_DELETE_BUTTON_MULTI).focus();\n        } else {\n            let tohide = SELECTORS.CONFIRM_TEXT_MULTI + ', ' + SELECTORS.CONFIRM_DELETE_BUTTON_MULTI + ',' +\n                SELECTORS.CANCEL_DELETE_BUTTON_MULTI;\n            let toshow = SELECTORS.CONFIRM_TEXT_SINGLE + ', ' + SELECTORS.CONFIRM_DELETE_BUTTON_SINGLE + ',' +\n                SELECTORS.CANCEL_DELETE_BUTTON_SINGLE;\n            $(tohide).addClass('hidden');\n            $(toshow).removeClass('hidden');\n            $(SELECTORS.CONFIRM_DELETE_BUTTON_SINGLE).data('noteid',\n                $(SELECTORS.HEADER_NOTE_DELETE).data('noteid'));\n            $(SELECTORS.CONFIRM_DELETE_BUTTON_SINGLE).focus();\n        }\n        window.scrollTo(0, $(SELECTORS.DIALOGUE_CONTAINER).position().top);\n    };\n\n    /**\n     * Submit form ajax.\n     * @return {boolean}\n     */\n    var submitFormAjax = () => {\n        if ($(document.activeElement).data('action') == 'reset') {\n            cancelNoteForm();\n        } else {\n            // Add an extra check in case one of the input is empty\n            if (isEmpty()) {\n                toggleSaveButton();\n                return;\n            }\n            let args = {};\n            args.noteid = $(SELECTORS.NOTE_FORM + ' input[name=\"noteid\"]').val();\n            args.subject = $(SELECTORS.NOTE_FORM + ' input[name=\"subject\"]').val();\n            args.note = $(SELECTORS.NOTE_SUMMARY).val();\n            ajax.call([{\n                methodname: 'local_notebook_update_note',\n                args: args,\n                done: function(result) {\n                    if (result) {\n                        // Refresh list.\n                        refreshNotes();\n                        // Display message success.\n                        displayMessageSuccess('notesaved');\n                        // Display Note view.\n                        displayNoteView();\n                        // Display note.\n                        displayNote(args.noteid);\n                        // hide the notes list if already the case before\n                        if(listNotesHidden) { hideNoteList(); }\n                    }\n                },\n                fail: notification.exception\n            }]);\n        }\n        return false;\n    };\n\n    /**\n     * Submit delete ajax.\n     * @return {boolean}\n     */\n    var submitDeleteAjax = () => {\n        let action = $(document.activeElement).data('action');\n        let notesids = [];\n        let keymessage = 'notedeleted';\n        if (action === 'confirm-delete-multiple') {\n            notesids = $(document.activeElement).data('noteid');\n            keymessage = 'notedeletedmultiple';\n        } else {\n            notesids.push($(document.activeElement).data('noteid'));\n        }\n        ajax.call([{\n            methodname: 'local_notebook_delete_notes',\n            args: {notes: notesids},\n            done: function(result) {\n                if (result) {\n                    // Close dialogue.\n                    closeConfirmDialogue('multiple', false);\n                    hideNoteView(false);\n                    // Display success message.\n                    displayMessageSuccess(keymessage);\n                    // Refresh list.\n                    refreshNotes();\n                    // Hide form.\n                    hideNoteForm();\n                }\n            },\n            fail: notification.exception\n        }]);\n        return false;\n    };\n\n    /**\n     * Cancel form.\n     *\n     */\n    var cancelNoteForm = () => {\n        displayNoteView();\n        $(SELECTORS.HEADER_NOTE_EDIT).focus();\n    };\n\n    /**\n     * Check if the editor is the tiny mce\n     * @returns {boolean} is tiny mce editor\n     */\n    var isTinyMceEditor = () => window.tinyMCE !== undefined;\n\n    /**\n     * Get the tiny mce editor\n     * @returns {object} Tiny Mce editor instance\n     */\n    var getTinyMce = () => window.tinyMCE.get(SELECTORS.NOTE_SUMMARY.replace('#', ''));\n\n    /**\n     * Hide note view.\n     *\n     * @param {String} focus\n     */\n    var hideNoteView = (focus) => {\n        $(SELECTORS.HEADER_NOTE_VIEW).addClass('hidden');\n        $(SELECTORS.HEADER_NOTE_VIEW).attr('aria-hidden', true);\n        $(SELECTORS.FOOTER_NOTE_VIEW).addClass('hidden');\n        $(SELECTORS.FOOTER_NOTE_VIEW).attr('aria-hidden', true);\n        $(SELECTORS.NOTE_VIEW).addClass('hidden');\n        $(SELECTORS.NOTE_VIEW).attr('aria-hidden', true);\n        $(SELECTORS.FORM_CONTAINER).removeClass('hidden');\n        $(SELECTORS.FORM_CONTAINER).removeAttr('aria-hidden');\n        // Set focus back to last item clicked.\n        if (!focus) {\n            return;\n        }\n        $(focus).focus();\n\n        if (!editorListenersInitialized) {\n            // Enable/disabled save button.\n            if (isTinyMceEditor()) {\n                getTinyMce().on('KeyUp', toggleSaveButton);\n                getTinyMce().on('ExecCommand', toggleSaveButton);\n            } else {\n                $(SELECTORS.FORM_CONTAINER + ' form textarea').on('change', toggleSaveButton);\n            }\n            $(SELECTORS.FORM_CONTAINER + ' form input[type=\"text\"]').on('input', toggleSaveButton);\n        }\n    };\n\n    /**\n    * Hide note List\n    */\n    var hideNoteList = () => {\n        // hide the note list section\n        $(SELECTORS.NOTE_LIST_CONTAINER).attr('display', 'none');\n        $(SELECTORS.NOTE_LIST_CONTAINER).removeClass().addClass('notelistcontainer hidden');\n        // make the section note view the full width of the page\n        $(SELECTORS.NOTE_DETAIL_CONTAINER).removeClass('col-xl-5');\n        $(SELECTORS.NOTE_DETAIL_CONTAINER).addClass('col-xl-12');\n        // switch the button to show notes list\n        $(SELECTORS.HEADER_NOTE_HIDE_LIST).addClass('hidden');\n        $(SELECTORS.HEADER_NOTE_HIDE_LIST).attr('aria-hidden', true);\n        $(SELECTORS.HEADER_NOTE_SHOW_LIST).removeClass('hidden');\n        $(SELECTORS.HEADER_NOTE_SHOW_LIST).removeAttr('aria-hidden');\n        // notes list hidden (listener)\n        listNotesHidden = true;\n    };\n\n    /**\n    * Show note List\n    */\n    var showNoteList = () => {\n        // hide the note list section\n        $(SELECTORS.NOTE_LIST_CONTAINER).removeClass('hidden');\n        $(SELECTORS.NOTE_LIST_CONTAINER).removeAttr('display');\n        $(SELECTORS.NOTE_LIST_CONTAINER).addClass('col-12 col-xl-7 d-flex flex-column border pr-2 pl-2  mt-2');\n        // make the section note view with default width\n        $(SELECTORS.NOTE_DETAIL_CONTAINER).removeClass('col-xl-12');\n        $(SELECTORS.NOTE_DETAIL_CONTAINER).addClass('col-xl-5');\n        // switch the button to hide notes list\n        $(SELECTORS.HEADER_NOTE_SHOW_LIST).addClass('hidden');\n        $(SELECTORS.HEADER_NOTE_SHOW_LIST).attr('aria-hidden', true);\n        $(SELECTORS.HEADER_NOTE_HIDE_LIST).removeClass('hidden');\n        $(SELECTORS.HEADER_NOTE_HIDE_LIST).removeAttr('aria-hidden');\n        // notes list shown (listener)\n        listNotesHidden = false;\n    };\n\n    /**\n     * Hide note view.\n     */\n    var hideNoteForm = () => {\n        $(SELECTORS.FORM_CONTAINER).addClass('hidden');\n        $(SELECTORS.FORM_CONTAINER).attr('aria-hidden', true);\n    };\n\n    /**\n     * Display note view.\n     */\n    var displayNoteView = () => {\n        $(SELECTORS.HEADER_NOTE_VIEW).removeClass('hidden');\n        $(SELECTORS.HEADER_NOTE_VIEW).removeAttr('aria-hidden');\n        $(SELECTORS.FOOTER_NOTE_VIEW).removeClass('hidden');\n        $(SELECTORS.FOOTER_NOTE_VIEW).removeAttr('aria-hidden');\n        $(SELECTORS.NOTE_VIEW).removeClass('hidden');\n        $(SELECTORS.NOTE_VIEW).removeAttr('aria-hidden');\n        $(SELECTORS.FORM_CONTAINER).addClass('hidden');\n        $(SELECTORS.FORM_CONTAINER).attr('aria-hidden', true);\n    };\n\n    /**\n     * Edit note view.\n     *\n     * @param {String} noteid\n     */\n    var editNoteView = (noteid) => {\n        ajax.call([{\n            methodname: 'local_notebook_read_note',\n            args: {noteid: noteid},\n            done: function(result) {\n                if (result) {\n                    if (isTinyMceEditor()) {\n                        getTinyMce().setContent(result.summary);\n                    } else {\n                        $(SELECTORS.FORM_CONTAINER + \" #id_notebook_editoreditable\").html(result.summary);\n                    }\n                    $(SELECTORS.NOTE_FORM + ' textarea').val($(SELECTORS.NOTE_VIEW + ' .textareaorigin').val());\n                    $(SELECTORS.NOTE_FORM + ' textarea').trigger('change');\n                    $(SELECTORS.NOTE_FORM + ' input[name=\"subject\"]').val(result.subject);\n                    $(SELECTORS.NOTE_FORM + ' input[name=\"noteid\"]').val(noteid);\n                    hideNoteView(SELECTORS.NOTE_FORM + ' input[name=\"subject\"]');\n                    toggleSaveButton();\n                }\n            },\n            fail: notification.exception\n        }]);\n    };\n\n    /**\n     * Display message success.\n     *\n     * @param {String} key the string identifier.\n     *\n     */\n    var displayMessageSuccess = (key) => {\n        // Remove old message.\n        $(SELECTORS.MESSAGE_SUCCESS_CONTAINER).html('');\n        var stringkeys = [\n            {\n                key: key,\n                component: 'local_notebook'\n            },\n            {\n                key: 'close',\n                component: 'core'\n            }\n        ];\n\n        str.get_strings(stringkeys).then(function(langStrings) {\n            let messageHtml = '<div class=\"alert alert-success alert-block fade in \" role=\"alert\">' +\n                '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"' + langStrings[1] + '\">×</button>' +\n                langStrings[0] + '</div>';\n            $(SELECTORS.MESSAGE_SUCCESS_CONTAINER).html(messageHtml);\n            $(SELECTORS.MESSAGE_SUCCESS_CONTAINER + ' .alert button').focus();\n            setTimeout(function() {\n                $(SELECTORS.MESSAGE_SUCCESS_CONTAINER + ' .alert').fadeOut();\n            }, 10000);\n        });\n    };\n\n    /**\n     * Toggle save button.\n     *\n     */\n    var toggleSaveButton = () => {\n        $(SELECTORS.NOTE_FORM + ' ' + SELECTORS.SAVE_BUTTON).prop('disabled', isEmpty());\n    };\n\n    /**\n     * Check if the title or the editor is empty\n     * @returns {boolean} Is empty\n     */\n    var isEmpty = ()=>{\n        let editorcontent = isTinyMceEditor()\n            ? getTinyMce().getContent()\n            : $(SELECTORS.FORM_CONTAINER + \" #id_notebook_editoreditable\").html();\n        let emptyTitle = $(SELECTORS.NOTE_FORM + ' input[type=\"text\"]').val() == '';\n        let emptyEditor = editorcontent !== undefined && editorcontent.replace(/<(.|\\n)*?>/g, '').trim().length === 0\n        && !editorcontent.includes(\"<img\");\n        return emptyTitle || emptyEditor;\n    };\n\n    /**\n     * Toggle delete button.\n     *\n     */\n    var toggleDeleteButton = () => {\n        let listempty = true;\n        if ($(SELECTORS.NOTEINDEX + ' ' + SELECTORS.CHECKBOX_LIST_NOTE + ':checked').length > 0) {\n            listempty = false;\n        }\n        if (listempty) {\n            $(SELECTORS.TABLE_DELETE_BUTTON).prop('disabled', true);\n        } else {\n            $(SELECTORS.TABLE_DELETE_BUTTON).prop('disabled', false);\n        }\n    };\n\n    /**\n     * Register events for the notebook index.\n     *\n     * @param {String} userid The user ID\n     * @param {String} courseid The course ID\n     * @param {String} coursemoduleid The cours module ID\n     */\n    var registerEventListeners = (userid, courseid, coursemoduleid) => {\n        this.userid = userid;\n        this.courseid = courseid;\n        this.coursemoduleid = coursemoduleid;\n        this.$table = $(SELECTORS.NOTE_TABLE);\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.REFRESH_BUTTON, function() {\n            refreshNotes();\n        });\n        // Note table row click event.\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.NOTE_TABLE_ROW + ' td:not(:first-child)', function(e) {\n            if (!$(e.target).hasClass('context-note') &&\n                !$(e.target).parent().hasClass('context-note')) {\n                let noteid = $(this).closest('tr').find('.viewnote').data('noteid');\n                $(SELECTORS.NOTEINDEX + ' #notebook-table-index tr.selected').removeClass('selected');\n                displayNote(noteid);\n                $(this).closest('tr').addClass('selected');\n            }\n        });\n        // Note table row checkbox cell click event.\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.NOTE_TABLE_ROW + ' td:first-child', function(e) {\n            if ($(this).find('.card-views').length) { // card view mode.\n                if (!$(e.target).is('label, input') &&\n                    !$(e.target).hasClass('context-note') &&\n                    !$(e.target).parent().hasClass('context-note')) {\n                    let noteid = $(this).closest('tr').find('.viewnote').data('noteid');\n                    $(SELECTORS.NOTEINDEX + ' #notebook-table-index tr.selected').removeClass('selected');\n                    displayNote(noteid);\n                    $(this).closest('tr').addClass('selected');\n                    window.scrollTo(0, $(SELECTORS.NOTE_DETAIL_CONTAINER).position().top);\n                }\n            } else {\n                $(this).find('input[type=\"checkbox\"]').trigger('click');\n            }\n        });\n        // Hide note list.\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.HEADER_NOTE_HIDE_LIST, function() {\n            hideNoteList();\n        });\n        // Show note list.\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.HEADER_NOTE_SHOW_LIST, function() {\n            showNoteList();\n        });\n        // Edit note.\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.HEADER_NOTE_EDIT, function() {\n            editNoteView($(this).data('noteid'));\n        });\n        // Cancel edit note.\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.CANCEL_BUTTON, function(e) {\n            e.preventDefault();\n            let noteid = $(SELECTORS.NOTE_FORM + ' input[name=\"noteid\"]').val();\n            displayNote(noteid);\n        });\n        // Cancel delete note.\n        $(SELECTORS.NOTEBOOKCONTAINER).on('click', SELECTORS.CANCEL_DELETE_BUTTON_SINGLE, function() {\n            closeConfirmDialogue('single', true);\n        });\n        $(SELECTORS.NOTEBOOKCONTAINER).on('click', SELECTORS.CANCEL_DELETE_BUTTON_MULTI, function() {\n            closeConfirmDialogue('multiple', true);\n        });\n        // Delete note button.\n        $(SELECTORS.NOTEINDEX).on('click', SELECTORS.DELETE_NOTE_BUTTON, function() {\n            let action = 'multiple';\n            if ($(this).data('noteid')) {\n                action = 'single';\n            }\n            showConfirmDialogue(action);\n        });\n        // Confirm delete note button.\n        $(SELECTORS.NOTEBOOKCONTAINER).on('click', SELECTORS.CONFIRM_DELETE_BUTTON_SINGLE + ' , ' +\n            SELECTORS.CONFIRM_DELETE_BUTTON_MULTI, submitDeleteAjax);\n\n        $(SELECTORS.FORM_CONTAINER).on('submit', 'form', submitFormAjax);\n\n        // Enable/disbled delete button.\n        $(SELECTORS.NOTEINDEX).on('change', SELECTORS.CHECKBOX_LIST_NOTE + ', ' + SELECTORS.CHECKBOX_ALL_NOTE,\n            toggleDeleteButton);\n    };\n\n    /**\n     * Initialise the notebook index.\n     *\n     * @param {String} userid The user ID\n     * @param {String} courseid The course ID\n     * @param {String} coursemoduleid The cours module ID\n     */\n    var init = (userid, courseid, coursemoduleid) => {\n        registerEventListeners(userid, courseid, coursemoduleid);\n        $(document).ready(function() {\n            displayNotes();\n        });\n    };\n\n    return {\n        init: init,\n    };\n});\n"],"names":["require","config","enforceDefine","shim","paths","bootstrapTable","M","cfg","wwwroot","bootstrapTableLocale","bootstrapTableLocaleMobile","define","$","notification","str","ajax","Templates","SELECTORS","NOTEBOOKCONTAINER","NOTEINDEX","HEADER_CONTAINER","BODY_CONTAINER","FORM_CONTAINER","CLOSE_BUTTON","NOTE_LIST_CONTAINER","NOTE_TABLE_CONTAINER","NOTE_TABLE","NOTE_TABLE_LOADING","REFRESH_BUTTON","SAVE_BUTTON","CANCEL_BUTTON","NOTE_FORM_ID","NOTE_SUMMARY","VIEW_NOTE","NOTE_VIEW","NOTE_TABLE_ROW","FOOTER_NOTE_VIEW","HEADER_NOTE_VIEW","HEADER_NOTE_CREATED_DATE","HEADER_NOTE_LAST_MODIFIED_DATE","NOTE_FORM","HEADER_NOTE_HIDE_LIST","HEADER_NOTE_SHOW_LIST","HEADER_NOTE_DELETE","HEADER_NOTE_EDIT","FOOTER_NOTE_TAGS","MESSAGE_SUCCESS_CONTAINER","DIALOGUE_CONTAINER","CONFIRM_TEXT_MULTI","CONFIRM_TEXT_SINGLE","CONFIRM_DELETE_BUTTON_MULTI","CONFIRM_DELETE_BUTTON_SINGLE","CANCEL_DELETE_BUTTON_MULTI","CANCEL_DELETE_BUTTON_SINGLE","DELETE_NOTE_BUTTON","CHECKBOX_LIST_NOTE","CHECKBOX_ALL_NOTE","TABLE_DELETE_BUTTON","TABLE_PAGINATION","NOTE_DETAIL_CONTAINER","listNotesHidden","refreshNotes","previousPageNumber","this","$table","pageNumber","displayNotes","displayNote","noteid","promises","displayNoteView","selectors","addClass","addBlurContent","call","methodname","args","id","done","result","data","subject","summary","timestamp","created","datecreation","Date","toLocaleDateString","document","documentElement","lang","day","month","year","timecreation","toLocaleTimeString","lastmodifiedtimestamp","lastmodified","lastmodifieddate","lastmodifiedtime","render","then","html","tags","tagshtml","forEach","item","badge","url","tooltip","title","removeClass","removeBlurContent","fail","Notification","exception","userid","courseid","coursemoduleid","get_strings","key","component","langStrings","each","index","value","text","push","locale","paginationParts","paginationSuccessivelySize","paginationPagesBySide","columns","field","checkbox","visible","sortable","sortName","formatter","nbtags","length","td","nbclass","width","titleTooltip","align","row","join","onPostBody","find","slice","wrapAll","dropdown","closeConfirmDialogue","action","focus","showConfirmDialogue","toshow","tohide","list","val","window","scrollTo","position","top","submitFormAjax","activeElement","cancelNoteForm","isEmpty","toggleSaveButton","note","displayMessageSuccess","hideNoteList","submitDeleteAjax","notesids","keymessage","notes","hideNoteView","hideNoteForm","isTinyMceEditor","undefined","tinyMCE","getTinyMce","get","replace","attr","removeAttr","on","stringkeys","messageHtml","setTimeout","fadeOut","prop","editorcontent","getContent","emptyTitle","emptyEditor","trim","includes","toggleDeleteButton","listempty","registerEventListeners","e","target","hasClass","parent","closest","is","trigger","setContent","preventDefault","init","ready"],"mappings":"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"}