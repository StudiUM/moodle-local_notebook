{"version":3,"sources":["../src/notebook_drawer.js"],"names":["require","config","enforceDefine","shim","paths","bootstrapTable","bootstrapTableLocale","bootstrapTableLocaleMobile","define","$","CustomEvents","Drawer","PubSub","notification","str","ajax","SELECTORS","JUMPTO","DRAWER","HEADER_CONTAINER","BODY_CONTAINER","CLOSE_BUTTON","NOTE_TABLE","REFRESH_BUTTON","Events","SHOW","HIDE","TOGGLE_VISIBILITY","show","root","attr","drawerRoot","getDrawerRoot","length","displayNotes","refreshNotes","$table","promises","call","methodname","args","userid","courseid","coursemoduleid","get_strings","key","component","then","langStrings","box","document","querySelector","height","offsetHeight","tableheight","data","done","result","each","index","value","push","id","subject","contextname","created","locale","documentElement","lang","paginationParts","paginationSuccessivelySize","paginationPagesBySide","columns","field","checkbox","title","sortable","width","formatter","row","nbclass","td","today","Date","toLocaleDateString","day","month","year","align","join","fail","exception","Notification","hide","isVisible","setJumpFrom","buttonid","contentRoot","closest","registerEventListeners","on","events","activate","subscribe","firstInput","find","focus","ROUTES_BACK","button","closebutton","e","originalEvent","preventDefault","publish","msdrawerRoot","messagetoggler","keycode","event","keyCode","which","type","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Controls the notebook drawer.\n *\n * @module     local_notebook/notebook_drawer\n * @copyright  2022 Université de Montréal\n * @author     Issam Taboubi <issam.taboubi@umontreal.ca>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nrequire.config({\n    enforceDefine: true,\n    shim: {\n        'bootstrapTable': ['jquery'],\n        'bootstrapTableLocale': ['jquery', 'bootstrapTable'],\n        'bootstrapTableLocaleMobile': ['jquery', 'bootstrapTable']\n    },\n    paths: {\n        bootstrapTable: '/local/notebook/amd/build/bootstrap-table.min',\n        bootstrapTableLocale: '/local/notebook/amd/build/bootstrap-table-locale-all.min',\n        bootstrapTableLocaleMobile: '/local/notebook/amd/build/bootstrap-table-mobile.min'\n    }\n});\n\ndefine(\n    [\n        'jquery',\n        'core/custom_interaction_events',\n        'core/drawer',\n        'core/pubsub',\n        'core/notification',\n        'core/str',\n        'core/ajax',\n        'bootstrapTable',\n        'bootstrapTableLocale',\n        'bootstrapTableLocaleMobile',\n    ],\n    function (\n        $,\n        CustomEvents,\n        Drawer,\n        PubSub,\n        notification,\n        str,\n        ajax\n    ) {\n\n        var SELECTORS = {\n            JUMPTO: '.notebookbutton [data-region=\"jumpto\"]',\n            DRAWER: '[data-region=\"right-hand-notebook-drawer\"]',\n            HEADER_CONTAINER: '[data-region=\"header-container\"]',\n            BODY_CONTAINER: '[data-region=\"body-container\"]',\n            CLOSE_BUTTON: '[data-action=\"closedrawer\"]',\n            NOTE_TABLE: '#notebook-table',\n            REFRESH_BUTTON: 'button[name=\"refresh\"]'\n        };\n        var Events = {\n            SHOW: 'notebook-drawer-show',\n            HIDE: 'notebook-drawer-hide',\n            TOGGLE_VISIBILITY: 'notebook-drawer-toggle',\n        };\n\n\n        /**\n         * Show the Notebook drawer.\n         *\n         * @param {Object} root The notebook drawer container.\n         */\n        var show = function (root) {\n            if (!root.attr('data-shown')) {\n                root.attr('data-shown', true);\n            }\n\n            var drawerRoot = getDrawerRoot(root);\n            if (drawerRoot.length) {\n                Drawer.show(drawerRoot);\n                // Here load list.\n                displayNotes();\n            }\n        };\n\n        /**\n         * Refresh notes.\n         *\n         */\n        var refreshNotes = function () {\n            this.$table.bootstrapTable('destroy');\n            displayNotes();\n        };\n\n        /**\n         * Display notes.\n         *\n         */\n        var displayNotes = function () {\n            var promises = [];\n\n            promises = ajax.call([{\n                methodname: 'local_notebook_notes_list',\n                args: {\n                    userid: this.userid,\n                    courseid: this.courseid,\n                    coursemoduleid: this.coursemoduleid\n                }\n            }]);\n            var stringkeys = [\n                {\n                    key: 'notetitle',\n                    component: 'local_notebook'\n                },\n                {\n                    key: 'notecontext',\n                    component: 'local_notebook',\n                },\n                {\n                    key: 'notedate',\n                    component: 'local_notebook',\n                },\n                {\n                    key: 'displaynote',\n                    component: 'local_notebook',\n                }\n            ];\n\n            str.get_strings(stringkeys).then(function(langStrings) {\n                let box = document.querySelector('[data-region=\"right-hand-notebook-drawer\"]');\n                let height = box.offsetHeight;\n                let tableheight = 460;\n                if (height < 700) {\n                    tableheight = 350;\n                } else if (height < 600) {\n                    tableheight = 300;\n                }\n\n                let data = [];\n                promises[0].done(function (result) {\n                    $.each(result, function (index, value) {\n                        data.push({\n                            'id': value.id,\n                            'subject': value.subject,\n                            'contextname': value.contextname,\n                            'created': value.created\n                        });\n                    });\n                    this.$table.bootstrapTable({\n                        locale: document.documentElement.lang,\n                        paginationParts: ['pageInfo', 'pageList'],\n                        paginationSuccessivelySize: 2,\n                        paginationPagesBySide: 1,\n                        data: data,\n                        height: tableheight,\n                        columns: [\n                            [{\n                                field: 'state',\n                                checkbox: true\n                            },\n                            {\n                                field: 'subject',\n                                title: langStrings[0],\n                                sortable: true,\n                                width: 300,\n                                formatter: subjectFormatter,\n                            },\n                            {\n                                field: 'contextname',\n                                title: langStrings[1],\n                                sortable: true\n                            },\n                            {\n                                field: 'created',\n                                title: langStrings[2],\n                                sortable: true,\n                                formatter: dateFormatter,\n                                width: 110\n                            },\n                            {\n                                field: 'operate',\n                                title: '',\n                                align: 'center',\n                                formatter: operateFormatter\n                            }]\n                        ]\n                    });\n\n                    /**\n                     * Format date.\n                     *\n                     * @param {String} value\n                     * @return {String}\n                     */\n                    function dateFormatter(value) {\n                        var today = new Date(value * 1000).toLocaleDateString(document.documentElement.lang, {\n                            day : 'numeric',\n                            month : 'short',\n                            year : 'numeric'\n                        });\n                        return today;\n                    }\n\n                    /**\n                     * Format subject.\n                     *\n                     * @param {String} value\n                     * @param {Object} row\n                     * @param {Integer} index\n                     * @return {String}\n                     */\n                    function subjectFormatter(value, row, index) {\n                        // To implet when doing tags.\n                        var nbclass = index % 2 === 0 ? 'wcn-1' : 'wcn-2';\n                        var td = \"<span class='text-truncate subject'>\" + value + \"</span><br>\";\n                        if (index % 2 === 0) {\n                            td += '<span class=\"badge badge-info text-truncate context-note ' +\n                            nbclass + '\">Demo course competencies FTFT-4647</span>';\n                        } else {\n                            td += '<span class=\"badge badge-info text-truncate context-note ' +\n                             nbclass + '\">Demo course competencies FTFT-4647</span>';\n                            td += '<span class=\"badge badge-info text-truncate context-note ' +\n                             nbclass + '\">Profil Issam Taboubi</span>';\n                        }\n                        return td;\n                    }\n\n                    /**\n                     * Display note button.\n                     *\n                     */\n                    function operateFormatter() {\n                        return [\n                            '<a class=\"edit\" title=\"' + langStrings[3] + '\">',\n                            '<i class=\"fa fa-chevron-right\"></i>',\n                            '</a>'\n                        ].join('');\n                    }\n\n                }).fail(notification.exception);\n            }).fail(Notification.exception);\n\n        };\n\n        /**\n         * Hide the notebook drawer.\n         *\n         * @param {Object} root The notebook drawer container.\n         */\n        var hide = function (root) {\n            var drawerRoot = getDrawerRoot(root);\n            if (drawerRoot.length) {\n                Drawer.hide(drawerRoot);\n            }\n        };\n\n        /**\n         * Check if the drawer is visible.\n         *\n         * @param {Object} root The notebook drawer container.\n         * @return {boolean}\n         */\n        var isVisible = function (root) {\n            var drawerRoot = getDrawerRoot(root);\n            if (drawerRoot.length) {\n                return Drawer.isVisible(drawerRoot);\n            }\n            return true;\n        };\n\n        /**\n         * Set Jump from button\n         *\n         * @param {String} buttonid The originating button id\n         */\n        var setJumpFrom = function (buttonid) {\n            $(SELECTORS.DRAWER).attr('data-origin', buttonid);\n        };\n\n        /**\n         * Find the root element of the drawer based on the using the drawer content root's ID.\n         *\n         * @param {Object} contentRoot The drawer content's root element.\n         * @returns {*|jQuery}\n         */\n        var getDrawerRoot = (contentRoot) => {\n            contentRoot = $(contentRoot);\n            return contentRoot.closest('[data-region=\"right-hand-notebook-drawer\"]');\n        };\n\n        /**\n         * Listen to showing and hiding the notebook drawer.\n         *\n         * @param {Object} root The notebook drawer container.\n         * @param {String} userid The user ID\n         * @param {String} courseid The course ID\n         * @param {String} coursemoduleid The cours module ID\n         */\n        var registerEventListeners = function (root, userid, courseid, coursemoduleid) {\n            this.userid = userid;\n            this.courseid = courseid;\n            this.coursemoduleid = coursemoduleid;\n            this.$table = $(SELECTORS.NOTE_TABLE);\n            $(SELECTORS.DRAWER).on('click', SELECTORS.REFRESH_BUTTON, function () {\n                refreshNotes();\n            });\n            CustomEvents.define(root, [CustomEvents.events.activate]);\n            PubSub.subscribe(Events.SHOW, function () {\n                show(root);\n            });\n\n            PubSub.subscribe(Events.HIDE, function () {\n                hide(root);\n            });\n\n            PubSub.subscribe(Events.TOGGLE_VISIBILITY, function (buttonid) {\n                if (isVisible(root)) {\n                    hide(root);\n                    $(SELECTORS.JUMPTO).attr('tabindex', -1);\n                } else {\n                    show(root);\n                    setJumpFrom(buttonid);\n                    $(SELECTORS.JUMPTO).attr('tabindex', 0);\n                }\n            });\n\n            $(SELECTORS.JUMPTO).on('focus', function () {\n                var firstInput = root.find(SELECTORS.CLOSE_BUTTON);\n                if (firstInput.length) {\n                    firstInput.focus();\n                } else {\n                    $(SELECTORS.HEADER_CONTAINER).find(SELECTORS.ROUTES_BACK).focus();\n                }\n            });\n\n            $(SELECTORS.DRAWER).focus(function () {\n                var button = $(this).attr('data-origin');\n                if (button) {\n                    $('#' + button).focus();\n                }\n            });\n\n            var closebutton = root.find(SELECTORS.CLOSE_BUTTON);\n            closebutton.on(CustomEvents.events.activate, function (e, data) {\n                data.originalEvent.preventDefault();\n                var button = $(SELECTORS.DRAWER).attr('data-origin');\n                if (button) {\n                    $('#' + button).focus();\n                }\n                PubSub.publish(Events.TOGGLE_VISIBILITY);\n            });\n\n            // If notebook drawer is visible and we open message drawer, hide notebook.\n            var msdrawerRoot = Drawer.getDrawerRoot($('[data-region=\"message-drawer\"]'));\n            var messagetoggler = $('[id^=\"message-drawer-toggle-\"]');\n            messagetoggler.on('click keydown keypress', function () {\n                var keycode = (event.keyCode ? event.keyCode : event.which);\n                // Enter, space or click.\n                if (keycode == '13' || keycode == '32' || event.type == 'click') {\n                    if (Drawer.isVisible(msdrawerRoot) && isVisible(root)) {\n                        hide(root);\n                    }\n                }\n            });\n        };\n\n        /**\n         * Initialise the notebook drawer.\n         *\n         * @param {Object} root The notebook drawer container.\n         * @param {String} userid The user ID\n         * @param {String} courseid The course ID\n         * @param {String} coursemoduleid The cours module ID\n         */\n        var init = function (root, userid, courseid, coursemoduleid) {\n            root = $(root);\n            registerEventListeners(root, userid, courseid, coursemoduleid);\n        };\n\n        return {\n            init: init,\n        };\n    });\n"],"file":"notebook_drawer.min.js"}