require.config({enforceDefine:!0,shim:{bootstrapTable:["jquery"],bootstrapTableLocale:["jquery","bootstrapTable"],bootstrapTableLocaleMobile:["jquery","bootstrapTable"]},paths:{bootstrapTable:"/local/notebook/amd/build/bootstrap-table.min",bootstrapTableLocale:"/local/notebook/amd/build/bootstrap-table-locale-all.min",bootstrapTableLocaleMobile:"/local/notebook/amd/build/bootstrap-table-mobile.min"}});define ("local_notebook/notebook_drawer",["jquery","core/custom_interaction_events","core/drawer","core/pubsub","core/notification","core/str","core/ajax","bootstrapTable","bootstrapTableLocale","bootstrapTableLocaleMobile"],function(a,b,c,d,e,f,g){var h={JUMPTO:".notebookbutton [data-region=\"jumpto\"]",DRAWER:"[data-region=\"right-hand-notebook-drawer\"]",HEADER_CONTAINER:"[data-region=\"header-container\"]",BODY_CONTAINER:"[data-region=\"body-container\"]",CLOSE_BUTTON:"[data-action=\"closedrawer\"]",NOTE_TABLE:"#notebook-table",REFRESH_BUTTON:"button[name=\"refresh\"]"},i={SHOW:"notebook-drawer-show",HIDE:"notebook-drawer-hide",TOGGLE_VISIBILITY:"notebook-drawer-toggle"},j=function(a){if(!a.attr("data-shown")){a.attr("data-shown",!0)}var b=p(a);if(b.length){c.show(b);l()}},k=function(){this.$table.bootstrapTable("destroy");l()},l=function(){var b=[];b=g.call([{methodname:"local_notebook_notes_list",args:{userid:this.userid,courseid:this.courseid,coursemoduleid:this.coursemoduleid}}]);f.get_strings([{key:"notetitle",component:"local_notebook"},{key:"notecontext",component:"local_notebook"},{key:"notedate",component:"local_notebook"},{key:"displaynote",component:"local_notebook"}]).then(function(c){var d=document.querySelector("[data-region=\"right-hand-notebook-drawer\"]"),f=d.offsetHeight,g=460;if(700>f){g=350}else if(600>f){g=300}var h=[];b[0].done(function(b){a.each(b,function(a,b){h.push({id:b.id,subject:b.subject,contextname:b.contextname,created:b.created})});this.$table.bootstrapTable({locale:document.documentElement.lang,paginationParts:["pageInfo","pageList"],paginationSuccessivelySize:2,paginationPagesBySide:1,data:h,height:g,columns:[[{field:"state",checkbox:!0},{field:"subject",title:c[0],sortable:!0,width:300,formatter:function(a,b,c){var d=0==c%2?"wcn-1":"wcn-2",e="<span class='text-truncate subject'>"+a+"</span><br>";if(0==c%2){e+="<span class=\"badge badge-info text-truncate context-note "+d+"\">Demo course competencies FTFT-4647</span>"}else{e+="<span class=\"badge badge-info text-truncate context-note "+d+"\">Demo course competencies FTFT-4647</span>";e+="<span class=\"badge badge-info text-truncate context-note "+d+"\">Profil Issam Taboubi</span>"}return e}},{field:"contextname",title:c[1],sortable:!0},{field:"created",title:c[2],sortable:!0,formatter:function(a){var b=new Date(1e3*a).toLocaleDateString(document.documentElement.lang,{day:"numeric",month:"short",year:"numeric"});return b},width:110},{field:"operate",title:"",align:"center",formatter:function(){return["<a class=\"edit\" title=\""+c[3]+"\">","<i class=\"fa fa-chevron-right\"></i>","</a>"].join("")}}]]})}).fail(e.exception)}).fail(Notification.exception)},m=function(a){var b=p(a);if(b.length){c.hide(b)}},n=function(a){var b=p(a);if(b.length){return c.isVisible(b)}return!0},o=function(b){a(h.DRAWER).attr("data-origin",b)},p=function(b){b=a(b);return b.closest("[data-region=\"right-hand-notebook-drawer\"]")},q=function(e,f,g,l){this.userid=f;this.courseid=g;this.coursemoduleid=l;this.$table=a(h.NOTE_TABLE);a(h.DRAWER).on("click",h.REFRESH_BUTTON,function(){k()});b.define(e,[b.events.activate]);d.subscribe(i.SHOW,function(){j(e)});d.subscribe(i.HIDE,function(){m(e)});d.subscribe(i.TOGGLE_VISIBILITY,function(b){if(n(e)){m(e);a(h.JUMPTO).attr("tabindex",-1)}else{j(e);o(b);a(h.JUMPTO).attr("tabindex",0)}});a(h.JUMPTO).on("focus",function(){var b=e.find(h.CLOSE_BUTTON);if(b.length){b.focus()}else{a(h.HEADER_CONTAINER).find(h.ROUTES_BACK).focus()}});a(h.DRAWER).focus(function(){var b=a(this).attr("data-origin");if(b){a("#"+b).focus()}});var p=e.find(h.CLOSE_BUTTON);p.on(b.events.activate,function(b,c){c.originalEvent.preventDefault();var e=a(h.DRAWER).attr("data-origin");if(e){a("#"+e).focus()}d.publish(i.TOGGLE_VISIBILITY)});var q=c.getDrawerRoot(a("[data-region=\"message-drawer\"]")),r=a("[id^=\"message-drawer-toggle-\"]");r.on("click keydown keypress",function(){var a=event.keyCode?event.keyCode:event.which;if("13"==a||"32"==a||"click"==event.type){if(c.isVisible(q)&&n(e)){m(e)}}})};return{init:function init(b,c,d,e){b=a(b);q(b,c,d,e)}}});
//# sourceMappingURL=notebook_drawer.min.js.map
